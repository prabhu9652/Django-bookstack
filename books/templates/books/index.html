{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container">
  <!-- Page Header -->
  <div class="section">
    <div class="flex items-center justify-between mb-6">
      <div>
        <h1>Books Library</h1>
        <p style="color: var(--text-secondary);">
          {% if template_data.category %}
            Category: {{ template_data.category.name }}
          {% else %}
            Browse our collection of technical books
          {% endif %}
        </p>
      </div>
      
      <!-- Search -->
      <div style="max-width: 300px;">
        <form method="GET" class="flex gap-2">
          <input type="text" name="search" class="form-control" placeholder="Search books..." 
                 value="{{ template_data.search_term|default:'' }}">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-search"></i>
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- Category Navigation -->
  {% if template_data.categories %}
  <div class="category-nav">
    <div class="container">
      <div class="category-list">
        <a href="{% url 'books.index' %}" class="category-item {% if not template_data.category %}active{% endif %}">
          All Books
        </a>
        {% for category in template_data.categories %}
          <a href="{% url 'books.category' category.slug %}" 
             class="category-item {% if template_data.category.id == category.id %}active{% endif %}">
            {{ category.name }}
          </a>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Books Grid -->
  <div class="section">
    {% if template_data.books %}
      <div class="grid grid-4">
        {% for book in template_data.books %}
          <div class="book-card" data-book-url="{% url 'books.show' book.id %}">
            <div class="book-cover">
              {% if book.cover %}
                <img src="{{ book.cover.url }}" alt="{{ book.name }}">
              {% else %}
                <i class="fas fa-book"></i>
              {% endif %}
            </div>
            <div class="book-info">
              <h4 class="book-title">{{ book.name }}</h4>
              <p class="book-author">{{ book.author|default:"Unknown Author" }}</p>
              {% if book.category %}
                <span class="book-category">{{ book.category.name }}</span>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Pagination -->
      {% if template_data.books.has_other_pages %}
        <div class="flex justify-center mt-8 gap-2">
          {% if template_data.books.has_previous %}
            <a href="?page={{ template_data.books.previous_page_number }}{% if template_data.search_term %}&search={{ template_data.search_term }}{% endif %}" 
               class="btn btn-secondary">
              <i class="fas fa-chevron-left"></i>
              Previous
            </a>
          {% endif %}
          
          <span class="flex items-center" style="padding: 0 var(--space-4); color: var(--text-secondary);">
            Page {{ template_data.books.number }} of {{ template_data.books.paginator.num_pages }}
          </span>
          
          {% if template_data.books.has_next %}
            <a href="?page={{ template_data.books.next_page_number }}{% if template_data.search_term %}&search={{ template_data.search_term }}{% endif %}" 
               class="btn btn-secondary">
              Next
              <i class="fas fa-chevron-right"></i>
            </a>
          {% endif %}
        </div>
      {% endif %}
    {% else %}
      <!-- Empty State -->
      <div class="text-center" style="padding: var(--space-16) 0;">
        <i class="fas fa-book-open" style="font-size: 4rem; color: var(--text-muted); margin-bottom: var(--space-4);"></i>
        <h3 style="color: var(--text-secondary); margin-bottom: var(--space-2);">No books found</h3>
        <p style="color: var(--text-tertiary);">
          {% if template_data.search_term %}
            No books match your search "{{ template_data.search_term }}". Try a different search term.
          {% else %}
            No books available in this category yet.
          {% endif %}
        </p>
        {% if template_data.search_term %}
          <a href="{% url 'books.index' %}" class="btn btn-secondary mt-4">
            <i class="fas fa-arrow-left"></i>
            View All Books
          </a>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
{% endblock content %}