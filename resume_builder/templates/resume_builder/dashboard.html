{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Resume Builder Enhanced Styles -->
<link rel="stylesheet" type="text/css" href="{% static 'css/resume-builder-enhancements.css' %}?v=20260110">
<div class="container" style="padding: var(--space-8) 0;">
  <!-- Header -->
  <div class="dashboard-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-8); animation: slideInDown 0.6s ease-out;">
    <div>
      <h1 style="font-size: var(--font-size-3xl); font-weight: 700; color: var(--text-primary); margin-bottom: var(--space-2);">
        <i class="fas fa-folder-open" style="color: var(--accent-primary); margin-right: var(--space-3);"></i>
        My Documents
      </h1>
      <p style="color: var(--text-secondary);">
        Manage your resumes and cover letters
      </p>
    </div>
    <div style="display: flex; gap: var(--space-3);">
      <a href="{% url 'resume_builder:resume_templates' %}" class="btn btn-primary" style="animation: slideInRight 0.6s ease-out 0.2s both;">
        <i class="fas fa-plus"></i>
        New Resume
      </a>
      <a href="{% url 'resume_builder:cover_letter_templates' %}" class="btn btn-secondary" style="animation: slideInRight 0.6s ease-out 0.3s both;">
        <i class="fas fa-plus"></i>
        New Cover Letter
      </a>
    </div>
  </div>

  <!-- Resumes Section -->
  <div class="documents-section" style="margin-bottom: var(--space-12); animation: slideInLeft 0.6s ease-out 0.4s both;">
    <div class="section-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
      <h2 style="font-size: var(--font-size-2xl); font-weight: 600; color: var(--text-primary); display: flex; align-items: center;">
        <div class="section-icon" style="width: 48px; height: 48px; background: var(--accent-subtle); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; margin-right: var(--space-4);">
          <i class="fas fa-file-alt" style="color: var(--accent-primary); font-size: var(--font-size-lg);"></i>
        </div>
        Resumes
      </h2>
      {% if resumes %}
        <span class="document-count" style="background: var(--accent-subtle); color: var(--accent-primary); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--font-size-sm); font-weight: 600;">
          {{ resumes|length }} document{{ resumes|length|pluralize }}
        </span>
      {% endif %}
    </div>
    
    {% if resumes %}
      <div class="documents-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: var(--space-6);">
        {% for resume in resumes %}
          <div class="document-card resume-card" data-document-id="{{ resume.id }}" data-document-type="resume" style="background: var(--bg-surface); border: 1px solid var(--border-primary); border-radius: var(--radius-xl); padding: var(--space-6); transition: all var(--transition-smooth); position: relative; overflow: hidden; animation: slideUp 0.4s ease-out {{ forloop.counter0|add:1|floatformat:1 }}s both;">
            <!-- Hover gradient overlay -->
            <div class="card-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, var(--accent-glow) 0%, transparent 50%); opacity: 0; transition: opacity var(--transition-smooth); pointer-events: none;"></div>
            
            <div class="document-header" style="display: flex; justify-content: space-between; align-items: start; margin-bottom: var(--space-4); position: relative; z-index: 2;">
              <div class="document-info" style="flex: 1;">
                <h3 class="document-title" style="font-size: var(--font-size-lg); font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2); line-height: 1.3;">
                  {{ resume.title }}
                </h3>
                <div class="document-meta" style="display: flex; flex-direction: column; gap: var(--space-1);">
                  <p style="color: var(--text-secondary); font-size: var(--font-size-sm); display: flex; align-items: center; gap: var(--space-2);">
                    <i class="fas fa-palette" style="color: var(--accent-primary); font-size: var(--font-size-xs);"></i>
                    {{ resume.template.name }}
                  </p>
                  <p style="color: var(--text-tertiary); font-size: var(--font-size-xs); display: flex; align-items: center; gap: var(--space-2);">
                    <i class="fas fa-clock" style="color: var(--text-muted);"></i>
                    Updated {{ resume.updated_at|date:"M d, Y" }}
                  </p>
                </div>
              </div>
              
              <!-- Actions Dropdown -->
              <div class="document-actions dropdown" style="position: relative;">
                <button class="actions-toggle btn btn-ghost btn-sm" data-dropdown="resume-{{ resume.id }}" style="padding: var(--space-2); border-radius: var(--radius-md); opacity: 0.7; transition: all var(--transition-fast);">
                  <i class="fas fa-ellipsis-v"></i>
                </button>
                <div class="dropdown-menu document-dropdown" id="resume-{{ resume.id }}-dropdown" style="position: absolute; top: 100%; right: 0; background: var(--bg-elevated); border: 1px solid var(--border-secondary); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); min-width: 180px; padding: var(--space-2); opacity: 0; visibility: hidden; transform: translateY(-10px) scale(0.95); transition: all var(--transition-fast); z-index: 1100; margin-top: var(--space-2);">
                  <a href="{% url 'resume_builder:edit_resume' resume.id %}" class="dropdown-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--text-secondary); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); text-decoration: none;">
                    <i class="fas fa-edit" style="color: var(--accent-primary); width: 16px; text-align: center;"></i>
                    Edit Resume
                  </a>
                  <a href="{% url 'resume_builder:preview_resume' resume.id %}" class="dropdown-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--text-secondary); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); text-decoration: none;">
                    <i class="fas fa-eye" style="color: var(--accent-primary); width: 16px; text-align: center;"></i>
                    Preview
                  </a>
                  <a href="{% url 'resume_builder:download_resume' resume.id %}" class="dropdown-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--text-secondary); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); text-decoration: none;">
                    <i class="fas fa-download" style="color: var(--accent-primary); width: 16px; text-align: center;"></i>
                    Download
                  </a>
                  <div class="dropdown-divider" style="height: 1px; background: var(--border-primary); margin: var(--space-2) 0;"></div>
                  <button type="button" class="dropdown-item delete-document-btn" data-document-id="{{ resume.id }}" data-document-type="resume" data-document-title="{{ resume.title }}" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--error); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); background: none; border: none; cursor: pointer; width: 100%;">
                    <i class="fas fa-trash" style="width: 16px; text-align: center;"></i>
                    Delete Resume
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="document-quick-actions" style="display: flex; gap: var(--space-2); position: relative; z-index: 2;">
              <a href="{% url 'resume_builder:edit_resume' resume.id %}" class="btn btn-primary btn-sm" style="flex: 1; justify-content: center;">
                <i class="fas fa-edit"></i> Edit
              </a>
              <a href="{% url 'resume_builder:preview_resume' resume.id %}" class="btn btn-ghost btn-sm" style="padding: var(--space-2) var(--space-3);">
                <i class="fas fa-eye"></i>
              </a>
              <a href="{% url 'resume_builder:download_resume' resume.id %}" class="btn btn-ghost btn-sm" style="padding: var(--space-2) var(--space-3);">
                <i class="fas fa-download"></i>
              </a>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty-state" style="background: var(--bg-surface); border: 1px solid var(--border-primary); border-radius: var(--radius-xl); padding: var(--space-12); text-align: center; position: relative; overflow: hidden;">
        <div class="empty-state-bg" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at center, var(--accent-glow-subtle) 0%, transparent 70%); opacity: 0.5;"></div>
        <div style="position: relative; z-index: 2;">
          <div class="empty-icon" style="width: 100px; height: 100px; background: var(--accent-subtle); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-6) auto; animation: pulse 2s ease-in-out infinite;">
            <i class="fas fa-file-alt" style="font-size: var(--font-size-4xl); color: var(--accent-primary);"></i>
          </div>
          <h3 style="font-size: var(--font-size-xl); font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-3);">
            No resumes yet
          </h3>
          <p style="color: var(--text-secondary); margin-bottom: var(--space-6); max-width: 400px; margin-left: auto; margin-right: auto; line-height: 1.6;">
            Create your first professional resume to get started on your career journey.
          </p>
          <a href="{% url 'resume_builder:resume_templates' %}" class="btn btn-primary btn-lg">
            <i class="fas fa-plus"></i>
            Create Your First Resume
          </a>
        </div>
      </div>
    {% endif %}
  </div>

  <!-- Cover Letters Section -->
  <div class="documents-section" style="animation: slideInRight 0.6s ease-out 0.6s both;">
    <div class="section-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-6);">
      <h2 style="font-size: var(--font-size-2xl); font-weight: 600; color: var(--text-primary); display: flex; align-items: center;">
        <div class="section-icon" style="width: 48px; height: 48px; background: var(--accent-subtle); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; margin-right: var(--space-4);">
          <i class="fas fa-envelope" style="color: var(--accent-primary); font-size: var(--font-size-lg);"></i>
        </div>
        Cover Letters
      </h2>
      {% if cover_letters %}
        <span class="document-count" style="background: var(--accent-subtle); color: var(--accent-primary); padding: var(--space-2) var(--space-3); border-radius: var(--radius-md); font-size: var(--font-size-sm); font-weight: 600;">
          {{ cover_letters|length }} document{{ cover_letters|length|pluralize }}
        </span>
      {% endif %}
    </div>
    
    {% if cover_letters %}
      <div class="documents-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: var(--space-6);">
        {% for cover_letter in cover_letters %}
          <div class="document-card cover-letter-card" data-document-id="{{ cover_letter.id }}" data-document-type="cover_letter" style="background: var(--bg-surface); border: 1px solid var(--border-primary); border-radius: var(--radius-xl); padding: var(--space-6); transition: all var(--transition-smooth); position: relative; overflow: hidden; animation: slideUp 0.4s ease-out {{ forloop.counter0|add:1|floatformat:1 }}s both;">
            <!-- Hover gradient overlay -->
            <div class="card-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, var(--accent-glow) 0%, transparent 50%); opacity: 0; transition: opacity var(--transition-smooth); pointer-events: none;"></div>
            
            <div class="document-header" style="display: flex; justify-content: space-between; align-items: start; margin-bottom: var(--space-4); position: relative; z-index: 2;">
              <div class="document-info" style="flex: 1;">
                <h3 class="document-title" style="font-size: var(--font-size-lg); font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-2); line-height: 1.3;">
                  {{ cover_letter.title }}
                </h3>
                <div class="document-meta" style="display: flex; flex-direction: column; gap: var(--space-1);">
                  <p style="color: var(--text-secondary); font-size: var(--font-size-sm); display: flex; align-items: center; gap: var(--space-2);">
                    <i class="fas fa-building" style="color: var(--accent-primary); font-size: var(--font-size-xs);"></i>
                    {{ cover_letter.company_name }}
                  </p>
                  <p style="color: var(--text-secondary); font-size: var(--font-size-sm); display: flex; align-items: center; gap: var(--space-2);">
                    <i class="fas fa-palette" style="color: var(--accent-primary); font-size: var(--font-size-xs);"></i>
                    {{ cover_letter.template.name }}
                  </p>
                  <p style="color: var(--text-tertiary); font-size: var(--font-size-xs); display: flex; align-items: center; gap: var(--space-2);">
                    <i class="fas fa-clock" style="color: var(--text-muted);"></i>
                    Updated {{ cover_letter.updated_at|date:"M d, Y" }}
                  </p>
                </div>
              </div>
              
              <!-- Actions Dropdown -->
              <div class="document-actions dropdown" style="position: relative;">
                <button class="actions-toggle btn btn-ghost btn-sm" data-dropdown="cover-letter-{{ cover_letter.id }}" style="padding: var(--space-2); border-radius: var(--radius-md); opacity: 0.7; transition: all var(--transition-fast);">
                  <i class="fas fa-ellipsis-v"></i>
                </button>
                <div class="dropdown-menu document-dropdown" id="cover-letter-{{ cover_letter.id }}-dropdown" style="position: absolute; top: 100%; right: 0; background: var(--bg-elevated); border: 1px solid var(--border-secondary); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); min-width: 180px; padding: var(--space-2); opacity: 0; visibility: hidden; transform: translateY(-10px) scale(0.95); transition: all var(--transition-fast); z-index: 1100; margin-top: var(--space-2);">
                  <a href="{% url 'resume_builder:edit_cover_letter' cover_letter.id %}" class="dropdown-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--text-secondary); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); text-decoration: none;">
                    <i class="fas fa-edit" style="color: var(--accent-primary); width: 16px; text-align: center;"></i>
                    Edit Cover Letter
                  </a>
                  <a href="{% url 'resume_builder:preview_cover_letter' cover_letter.id %}" class="dropdown-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--text-secondary); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); text-decoration: none;">
                    <i class="fas fa-eye" style="color: var(--accent-primary); width: 16px; text-align: center;"></i>
                    Preview
                  </a>
                  <a href="{% url 'resume_builder:download_cover_letter' cover_letter.id %}" class="dropdown-item" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--text-secondary); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); text-decoration: none;">
                    <i class="fas fa-download" style="color: var(--accent-primary); width: 16px; text-align: center;"></i>
                    Download
                  </a>
                  <div class="dropdown-divider" style="height: 1px; background: var(--border-primary); margin: var(--space-2) 0;"></div>
                  <button type="button" class="dropdown-item delete-document-btn" data-document-id="{{ cover_letter.id }}" data-document-type="cover_letter" data-document-title="{{ cover_letter.title }}" style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3) var(--space-4); color: var(--error); font-size: var(--font-size-sm); font-weight: 500; border-radius: var(--radius-md); transition: all var(--transition-fast); background: none; border: none; cursor: pointer; width: 100%;">
                    <i class="fas fa-trash" style="width: 16px; text-align: center;"></i>
                    Delete Cover Letter
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="document-quick-actions" style="display: flex; gap: var(--space-2); position: relative; z-index: 2;">
              <a href="{% url 'resume_builder:edit_cover_letter' cover_letter.id %}" class="btn btn-primary btn-sm" style="flex: 1; justify-content: center;">
                <i class="fas fa-edit"></i> Edit
              </a>
              <a href="{% url 'resume_builder:preview_cover_letter' cover_letter.id %}" class="btn btn-ghost btn-sm" style="padding: var(--space-2) var(--space-3);">
                <i class="fas fa-eye"></i>
              </a>
              <a href="{% url 'resume_builder:download_cover_letter' cover_letter.id %}" class="btn btn-ghost btn-sm" style="padding: var(--space-2) var(--space-3);">
                <i class="fas fa-download"></i>
              </a>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty-state" style="background: var(--bg-surface); border: 1px solid var(--border-primary); border-radius: var(--radius-xl); padding: var(--space-12); text-align: center; position: relative; overflow: hidden;">
        <div class="empty-state-bg" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at center, var(--accent-glow-subtle) 0%, transparent 70%); opacity: 0.5;"></div>
        <div style="position: relative; z-index: 2;">
          <div class="empty-icon" style="width: 100px; height: 100px; background: var(--accent-subtle); border-radius: var(--radius-xl); display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-6) auto; animation: pulse 2s ease-in-out infinite;">
            <i class="fas fa-envelope" style="font-size: var(--font-size-4xl); color: var(--accent-primary);"></i>
          </div>
          <h3 style="font-size: var(--font-size-xl); font-weight: 600; color: var(--text-primary); margin-bottom: var(--space-3);">
            No cover letters yet
          </h3>
          <p style="color: var(--text-secondary); margin-bottom: var(--space-6); max-width: 400px; margin-left: auto; margin-right: auto; line-height: 1.6;">
            Create your first cover letter to complement your resume and make a great impression.
          </p>
          <a href="{% url 'resume_builder:cover_letter_templates' %}" class="btn btn-primary btn-lg">
            <i class="fas fa-plus"></i>
            Create Your First Cover Letter
          </a>
        </div>
      </div>
    {% endif %}
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(4px); z-index: 2000; opacity: 0; transition: opacity var(--transition-smooth);">
  <div class="modal-content" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9); background: var(--bg-elevated); border: 1px solid var(--border-secondary); border-radius: var(--radius-xl); padding: var(--space-8); max-width: 480px; width: 90%; box-shadow: var(--shadow-lg); transition: transform var(--transition-smooth);">
    <div class="modal-header" style="text-align: center; margin-bottom: var(--space-6);">
      <div class="modal-icon" style="width: 80px; height: 80px; background: rgba(239, 68, 68, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-4);">
        <i class="fas fa-exclamation-triangle" style="font-size: var(--font-size-3xl); color: var(--error);"></i>
      </div>
      <h3 style="font-size: var(--font-size-xl); font-weight: 700; color: var(--text-primary); margin-bottom: var(--space-2);">
        Delete Document
      </h3>
      <p id="deleteMessage" style="color: var(--text-secondary); line-height: 1.6;">
        Are you sure you want to delete this document? This action cannot be undone.
      </p>
    </div>
    
    <div class="modal-actions" style="display: flex; gap: var(--space-3); justify-content: center;">
      <button id="cancelDelete" class="btn btn-secondary">
        <i class="fas fa-times"></i>
        Cancel
      </button>
      <button id="confirmDelete" class="btn btn-primary" style="background: var(--error); border-color: var(--error);">
        <i class="fas fa-trash"></i>
        Delete Document
      </button>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Enhanced dropdown functionality
  function setupDropdowns() {
    const dropdowns = document.querySelectorAll('.dropdown');
    
    dropdowns.forEach(dropdown => {
      const toggle = dropdown.querySelector('[data-dropdown]');
      const menu = dropdown.querySelector('.dropdown-menu');
      
      if (!toggle || !menu) return;
      
      // Click to toggle dropdown
      toggle.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        
        // Close other dropdowns
        dropdowns.forEach(other => {
          if (other !== dropdown) {
            const otherMenu = other.querySelector('.dropdown-menu');
            if (otherMenu) {
              otherMenu.style.opacity = '0';
              otherMenu.style.visibility = 'hidden';
              otherMenu.style.transform = 'translateY(-10px) scale(0.95)';
            }
          }
        });
        
        // Toggle current dropdown
        const isOpen = menu.style.opacity === '1';
        if (isOpen) {
          menu.style.opacity = '0';
          menu.style.visibility = 'hidden';
          menu.style.transform = 'translateY(-10px) scale(0.95)';
        } else {
          menu.style.opacity = '1';
          menu.style.visibility = 'visible';
          menu.style.transform = 'translateY(0) scale(1)';
        }
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (!dropdown.contains(e.target)) {
          menu.style.opacity = '0';
          menu.style.visibility = 'hidden';
          menu.style.transform = 'translateY(-10px) scale(0.95)';
        }
      });
      
      // Prevent dropdown menu clicks from closing the dropdown
      menu.addEventListener('click', (e) => {
        e.stopPropagation();
      });
    });
  }
  
  // Enhanced card hover effects
  function setupCardEffects() {
    const cards = document.querySelectorAll('.document-card');
    
    cards.forEach(card => {
      const overlay = card.querySelector('.card-overlay');
      const actionsToggle = card.querySelector('.actions-toggle');
      
      card.addEventListener('mouseenter', () => {
        card.style.transform = 'translateY(-8px) scale(1.02)';
        card.style.borderColor = 'var(--accent-primary)';
        card.style.boxShadow = 'var(--shadow-lg), var(--glow-subtle)';
        if (overlay) overlay.style.opacity = '0.1';
        if (actionsToggle) actionsToggle.style.opacity = '1';
      });
      
      card.addEventListener('mouseleave', () => {
        card.style.transform = 'translateY(0) scale(1)';
        card.style.borderColor = 'var(--border-primary)';
        card.style.boxShadow = 'none';
        if (overlay) overlay.style.opacity = '0';
        if (actionsToggle) actionsToggle.style.opacity = '0.7';
      });
    });
  }
  
  // Delete functionality with confirmation modal
  function setupDeleteFunctionality() {
    const modal = document.getElementById('deleteModal');
    const deleteMessage = document.getElementById('deleteMessage');
    const cancelBtn = document.getElementById('cancelDelete');
    const confirmBtn = document.getElementById('confirmDelete');
    let currentDeleteData = null;
    
    // Show modal
    function showModal(documentData) {
      currentDeleteData = documentData;
      const docType = documentData.type === 'resume' ? 'resume' : 'cover letter';
      deleteMessage.textContent = `Are you sure you want to delete "${documentData.title}"? This ${docType} will be permanently removed and cannot be recovered.`;
      
      modal.style.display = 'block';
      setTimeout(() => {
        modal.style.opacity = '1';
        modal.querySelector('.modal-content').style.transform = 'translate(-50%, -50%) scale(1)';
      }, 10);
    }
    
    // Hide modal
    function hideModal() {
      modal.style.opacity = '0';
      modal.querySelector('.modal-content').style.transform = 'translate(-50%, -50%) scale(0.9)';
      setTimeout(() => {
        modal.style.display = 'none';
        currentDeleteData = null;
      }, 300);
    }
    
    // Delete document with animation
    function deleteDocument(documentData) {
      const card = document.querySelector(`[data-document-id="${documentData.id}"][data-document-type="${documentData.type}"]`);
      
      if (card) {
        // Animate card removal
        card.style.transform = 'scale(0.8)';
        card.style.opacity = '0';
        card.style.transition = 'all 0.3s ease-out';
        
        setTimeout(() => {
          // Create and submit form
          const form = document.createElement('form');
          form.method = 'POST';
          form.action = documentData.type === 'resume' 
            ? `/resume-builder/delete-resume/${documentData.id}/`
            : `/resume-builder/delete-cover-letter/${documentData.id}/`;
          
          const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || 
                           document.querySelector('meta[name=csrf-token]')?.content;
          
          if (csrfToken) {
            const csrfInput = document.createElement('input');
            csrfInput.type = 'hidden';
            csrfInput.name = 'csrfmiddlewaretoken';
            csrfInput.value = csrfToken;
            form.appendChild(csrfInput);
          }
          
          document.body.appendChild(form);
          form.submit();
        }, 300);
      }
    }
    
    // Event listeners
    document.addEventListener('click', (e) => {
      if (e.target.closest('.delete-document-btn')) {
        e.preventDefault();
        const btn = e.target.closest('.delete-document-btn');
        const documentData = {
          id: btn.dataset.documentId,
          type: btn.dataset.documentType,
          title: btn.dataset.documentTitle
        };
        showModal(documentData);
      }
    });
    
    cancelBtn.addEventListener('click', hideModal);
    
    confirmBtn.addEventListener('click', () => {
      if (currentDeleteData) {
        hideModal();
        setTimeout(() => deleteDocument(currentDeleteData), 100);
      }
    });
    
    // Close modal on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal.style.display === 'block') {
        hideModal();
      }
    });
    
    // Close modal on backdrop click
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        hideModal();
      }
    });
  }
  
  // Initialize all functionality
  setupDropdowns();
  setupCardEffects();
  setupDeleteFunctionality();
});
</script>

<style>
@keyframes slideInDown {
  from {
    opacity: 0;
    transform: translateY(-30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 var(--accent-glow);
  }
  50% {
    transform: scale(1.05);
    box-shadow: 0 0 0 20px transparent;
  }
}

.dropdown-item:hover {
  color: var(--text-primary) !important;
  background: var(--accent-subtle) !important;
  transform: translateX(2px);
}

.document-card {
  cursor: pointer;
}

.document-card:hover .actions-toggle {
  opacity: 1 !important;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .documents-grid {
    grid-template-columns: 1fr !important;
  }
  
  .dashboard-header {
    flex-direction: column !important;
    gap: var(--space-4) !important;
    text-align: center !important;
  }
  
  .section-header {
    flex-direction: column !important;
    gap: var(--space-3) !important;
    text-align: center !important;
  }
}

@media (max-width: 480px) {
  .document-quick-actions {
    flex-direction: column !important;
  }
  
  .modal-content {
    width: 95% !important;
    padding: var(--space-6) !important;
  }
  
  .modal-actions {
    flex-direction: column !important;
  }
}
</style>
{% endblock %}