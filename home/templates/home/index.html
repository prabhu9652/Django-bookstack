{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container" style="padding: var(--space-8) 0;">
  <!-- Header -->
  <div class="animate-slide-down" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-12);">
    <div>
      <h1 class="d-flex align-items-center gap-3 mb-2">
        <div style="width: 56px; height: 56px; background-color: var(--accent-subtle); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center;">
          <i class="fas fa-terminal" style="color: var(--accent-primary); font-size: var(--font-size-xl);"></i>
        </div>
        Engineering Platform
      </h1>
      <p class="text-secondary">
        Professional resources for developers and engineers. Books, career tools, and technical roadmaps.
      </p>
    </div>
    <div class="d-flex gap-3">
      {% if user.is_authenticated %}
        <a href="{% url 'books.index' %}" class="btn btn-primary animate-slide-right animate-stagger-1">
          <i class="fas fa-book"></i>
          Browse Books
        </a>
      {% else %}
        <a href="{% url 'books.index' %}" class="btn btn-primary animate-slide-right animate-stagger-1">
          <i class="fas fa-book"></i>
          Browse Books
        </a>
        <a href="{% url 'accounts.signup' %}" class="btn btn-secondary animate-slide-right animate-stagger-2">
          <i class="fas fa-user-plus"></i>
          Get Started
        </a>
      {% endif %}
    </div>
  </div>

  <!-- Core Features Section -->
  <div class="animate-slide-left animate-stagger-2" style="margin-bottom: var(--space-20);">
    <div class="d-flex align-items-center justify-content-between mb-6">
      <h2 class="d-flex align-items-center">
        <div class="feature-icon mr-4">
          <i class="fas fa-layer-group"></i>
        </div>
        Platform Features
      </h2>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: var(--space-6);">
      <!-- Books & Knowledge Hub -->
      <a href="{% url 'books.index' %}" class="feature-card animate-slide-up animate-stagger-1">
        <div class="feature-icon">
          <i class="fas fa-book"></i>
        </div>
        <h3 class="mb-3">Books & Knowledge Hub</h3>
        <p class="text-secondary mb-4">
          Professional technical books covering DevOps, Cloud Computing, Data Science, and Software Development.
        </p>
        <div class="d-flex align-items-center gap-3">
          <div class="meta-item">
            <i class="fas fa-book-open"></i>
            <span>{{ template_data.total_books|default:"500+" }} Books</span>
          </div>
        </div>
      </a>

      <!-- My Library -->
      {% if user.is_authenticated %}
        <a href="{% url 'library.index' %}" class="feature-card animate-slide-up animate-stagger-2">
      {% else %}
        <div class="feature-card animate-slide-up animate-stagger-2">
      {% endif %}
        <div class="feature-icon">
          <i class="fas fa-bookmark"></i>
        </div>
        <h3 class="mb-3">My Library</h3>
        <p class="text-secondary mb-4">
          Personal collection of saved books and reading progress. Organize your technical learning journey.
        </p>
        <div class="d-flex align-items-center gap-3">
          {% if user.is_authenticated %}
            <div class="document-status">
              <i class="fas fa-check-circle"></i>
              Available
            </div>
          {% else %}
            <div class="meta-item">
              <i class="fas fa-lock"></i>
              <span>Sign in required</span>
            </div>
          {% endif %}
        </div>
      {% if user.is_authenticated %}
        </a>
      {% else %}
        </div>
      {% endif %}

      <!-- Resume Builder -->
      <a href="{% url 'resume_builder:home' %}" class="feature-card animate-slide-up animate-stagger-3">
        <div class="feature-icon">
          <i class="fas fa-file-alt"></i>
        </div>
        <h3 class="mb-3">Resume Builder</h3>
        <p class="text-secondary mb-4">
          Professional resume and cover letter builder with enterprise-grade templates for technical roles.
        </p>
        <div class="d-flex gap-2" style="flex-wrap: wrap;">
          <div class="meta-item">
            <i class="fas fa-check"></i>
            <span>ATS-Friendly</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-check"></i>
            <span>Live Preview</span>
          </div>
        </div>
      </a>

      <!-- Career Roadmaps -->
      <a href="{% url 'roadmap:home' %}" class="feature-card animate-slide-up animate-stagger-4">
        <div class="feature-icon">
          <i class="fas fa-route"></i>
        </div>
        <h3 class="mb-3">Career Roadmaps</h3>
        <p class="text-secondary mb-4">
          Structured learning paths from DevOps to Full-Stack Development to Data Science & Machine Learning.
        </p>
        <div class="d-flex gap-2" style="flex-wrap: wrap;">
          <div class="meta-item">
            <i class="fas fa-cogs"></i>
            <span>DevOps</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-code"></i>
            <span>Full-Stack</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-chart-line"></i>
            <span>DSML</span>
          </div>
        </div>
      </a>
    </div>
  </div>

  <!-- Recent Books Section -->
  {% if template_data.recent_books %}
  <div class="animate-slide-right animate-stagger-3" style="margin-top: var(--space-20); margin-bottom: var(--space-20);">
    <div class="d-flex align-items-center justify-content-between mb-6">
      <h2 class="d-flex align-items-center">
        <div class="feature-icon mr-4">
          <i class="fas fa-book-open"></i>
        </div>
        Latest Technical Books
      </h2>
      <a href="{% url 'books.index' %}" class="btn btn-ghost">
        View All Books
        <i class="fas fa-arrow-right"></i>
      </a>
    </div>
    
    <div class="books-grid mb-4">
      {% for book in template_data.recent_books %}
        <a href="{% url 'books.show' book.id %}" class="book-card animate-slide-up animate-stagger-{{ forloop.counter }}">
          <!-- Book Cover -->
          <div class="book-cover">
            {% if book.cover %}
              <img src="{{ book.cover.url }}" alt="{{ book.name }}" loading="lazy">
            {% else %}
              <div class="book-cover-placeholder">
                <i class="fas fa-file-code"></i>
                <span>Technical Book</span>
              </div>
            {% endif %}
          </div>
          
          <!-- Book Info -->
          <div class="book-info">
            <div>
              <h4 class="book-title">{{ book.name }}</h4>
              <p class="book-author">{{ book.author|default:"Technical Author" }}</p>
              
              {% if book.category %}
                <div class="book-category">
                  {% if 'devops' in book.category.name|lower %}
                    <i class="fas fa-cogs"></i>
                  {% elif 'cloud' in book.category.name|lower %}
                    <i class="fas fa-cloud"></i>
                  {% elif 'data' in book.category.name|lower %}
                    <i class="fas fa-chart-bar"></i>
                  {% elif 'machine' in book.category.name|lower %}
                    <i class="fas fa-robot"></i>
                  {% elif 'software' in book.category.name|lower %}
                    <i class="fas fa-code"></i>
                  {% elif 'database' in book.category.name|lower %}
                    <i class="fas fa-database"></i>
                  {% else %}
                    <i class="fas fa-book"></i>
                  {% endif %}
                  <span>{{ book.category.name }}</span>
                </div>
              {% endif %}
            </div>
          </div>
        </a>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <!-- Platform Stats Section -->
  <div class="animate-slide-left animate-stagger-4" style="margin-top: var(--space-20); margin-bottom: var(--space-20);">
    <div class="text-center mb-6">
      <h2 class="d-flex align-items-center justify-content-center">
        <div class="feature-icon mr-4">
          <i class="fas fa-chart-bar"></i>
        </div>
        Platform Overview
      </h2>
    </div>
    
    <div class="stats-grid">
      <div class="stat-card animate-slide-up animate-stagger-1">
        <div class="feature-icon mb-3">
          <i class="fas fa-book"></i>
        </div>
        <div class="stat-number">{{ template_data.total_books|default:"500+" }}</div>
        <div class="stat-label">Technical Books</div>
      </div>
      
      <div class="stat-card animate-slide-up animate-stagger-2">
        <div class="feature-icon mb-3">
          <i class="fas fa-layer-group"></i>
        </div>
        <div class="stat-number">{{ template_data.total_categories|default:"8+" }}</div>
        <div class="stat-label">Tech Categories</div>
      </div>
      
      <div class="stat-card animate-slide-up animate-stagger-3">
        <div class="feature-icon mb-3">
          <i class="fas fa-users"></i>
        </div>
        <div class="stat-number">{{ template_data.total_users|default:"2000+" }}</div>
        <div class="stat-label">Engineers & Developers</div>
      </div>
    </div>
  </div>

  <!-- Call to Action -->
  {% if not user.is_authenticated %}
  <div class="text-center" style="margin-top: var(--space-24);">
    <div class="card" style="max-width: 600px; margin: 0 auto; padding: var(--space-12);">
      <div class="empty-icon mb-6 animate-pulse">
        <i class="fas fa-rocket"></i>
      </div>
      <h3 class="mb-4">Join the Engineering Platform</h3>
      <p class="text-secondary mb-8">
        Access professional technical resources, build your resume, and advance your engineering career with our comprehensive platform.
      </p>
      <div class="d-flex gap-3 justify-content-center" style="flex-wrap: wrap;">
        <a href="{% url 'accounts.signup' %}" class="btn btn-primary btn-lg">
          <i class="fas fa-user-plus"></i>
          Create Account
        </a>
        <a href="{% url 'accounts.login' %}" class="btn btn-secondary btn-lg">
          <i class="fas fa-sign-in-alt"></i>
          Sign In
        </a>
      </div>
    </div>
  </div>
  {% endif %}
</div>

<script>
// Enhanced Home page functionality
document.addEventListener('DOMContentLoaded', function() {
  // Animate elements on scroll
  const animateElements = document.querySelectorAll('[class*="animate-"]');
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.animationPlayState = 'running';
      }
    });
  }, { threshold: 0.1 });
  
  animateElements.forEach(el => {
    observer.observe(el);
  });
  
  // Enhanced card interactions
  const cards = document.querySelectorAll('.feature-card, .book-card, .stat-card');
  cards.forEach(card => {
    card.addEventListener('click', function(e) {
      if (e.target.closest('.btn') || e.target.closest('button')) {
        return;
      }
      
      const link = this.getAttribute('href');
      if (link) {
        window.location.href = link;
      }
    });
    
    // Keyboard support
    if (card.getAttribute('href')) {
      card.setAttribute('tabindex', '0');
      card.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          this.click();
        }
      });
    }
  });
});
</script>
{% endblock content %}